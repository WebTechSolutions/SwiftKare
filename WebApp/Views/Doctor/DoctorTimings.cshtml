
@{
    ViewBag.Title = "Doctor Timings";
    Layout = "~/Views/Shared/_DoctorLayout.cshtml";
}


<!-- page content -->


<div class="right_col" style="min-height: 1779px;">
    <div class="x_panel">
        
        <div class="x_title">
            <h2>Schedule</h2>
            <ul class="nav navbar-right panel_toolbox">
                <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a></li>
            </ul>
            <div class="clearfix"></div>
        </div>
        <div class="x_content">
            <div class="row">
                <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                    <label class="control-label">Day:</label>
                    <div class="form-group">
                        <select id="DoctorTiming_day" class="form-control">
                            <option>Monday</option>
                            <option>Tuesday</option>
                            <option>Wednesday</option>
                            <option>Thursday</option>
                            <option>Friday</option>
                            <option>Saturday</option>
                            <option>Sunday</option>
                        </select>
                    </div>
                </div>
                <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-control-wrapper">
                        <div class="form-group label-floating is-empty">
                            <label for="time" class="control-label">From Time</label>
                            <input id="DoctorTiming_from" class="form-control" data-dtp="dtp_0Gd9z" type="text">
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-control-wrapper">
                        <div class="form-group label-floating is-empty">
                            <label for="time" class="control-label">To Time</label>
                            <input id="DoctorTiming_to" class="form-control" data-dtp="dtp_bTytq" type="text">
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                    <button class="btn btn-primary" onclick="addUpdate();" style="margin-top: 26px;" type="button">Add</button>
                    <button class="btn btn-primary" onclick="reset();" style="margin-top: 26px;" type="button">Reset</button>
                </div>
            </div>

            <div class="x_panel">
                <div class="x_title">
                    
                    <div class="table-responsive">
                        <div id="divLoader" style="display:none;" class="loader"></div>

                        <table id="datatable" class="table table-striped table-bordered" cellspacing="0" width="100%">
                            <thead>
                                <tr class="headings">
                                    <th class="column-title">Day</th>
                                    <th class="column-title">From</th>
                                    <th class="column-title">To </th>
                                    <th class="column-title">Action</th>
                                </tr>
                            </thead>
                            <tbody id="timingTable"></tbody>
                        </table>
                    </div>
                    ---------------------------------


                    <h2>Days</h2>
                    <ul class="nav navbar-right panel_toolbox">
                        <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a></li>
                    </ul>
                    <div class="clearfix"></div>
                </div>
                <div class="x_content" style="display: block;">
                    <div class="table-responsive">
                        <h2>Monday</h2>
                        <table class="table table-striped table-bordered dataTable no-footer">
                            <tbody>
                                <tr class="time_btn">
                                    <td class="time-remove"><span>8:00am To 9:00am</span> <button class="btn btn-primary" type="button">Delete</button></td>
                                </tr>

                                <tr class="time_btn">
                                    <td class="time-remove"><span>8:00am To 9:00am</span> <button class="btn btn-primary" type="button">Delete</button></td>
                                </tr>

                                <tr class="time_btn">
                                    <td class="time-remove"><span>8:00am To 9:00am</span> <button class="btn btn-primary" type="button">Delete</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div><!-- monday -->

                    <div class="table-responsive">
                        <h2>Tuesday</h2>
                        <table class="table table-striped table-bordered dataTable no-footer">
                            <tbody>
                                <tr class="time_btn">
                                    <td class="time-remove"><span>8:00am To 9:00am</span> <button class="btn btn-primary" type="button">Delete</button></td>
                                </tr>

                                <tr class="time_btn">
                                    <td class="time-remove"><span>8:00am To 9:00am</span> <button class="btn btn-primary" type="button">Delete</button></td>
                                </tr>

                                <tr class="time_btn">
                                    <td class="time-remove"><span>8:00am To 9:00am</span> <button class="btn btn-primary" type="button">Delete</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div><!-- Tuesday -->

                    <div class="table-responsive">
                        <h2>Wednesday</h2>
                        <table class="table table-striped table-bordered dataTable no-footer">
                            <tbody>
                                <tr class="time_btn">
                                    <td class="time-remove"><span>8:00am To 9:00am</span> <button class="btn btn-primary" type="button">Delete</button></td>
                                </tr>

                                <tr class="time_btn">
                                    <td class="time-remove"><span>8:00am To 9:00am</span> <button class="btn btn-primary" type="button">Delete</button></td>
                                </tr>

                                <tr class="time_btn">
                                    <td class="time-remove"><span>8:00am To 9:00am</span> <button class="btn btn-primary" type="button">Delete</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div><!-- Wednesday -->

                    <div class="table-responsive">
                        <h2>Thursday</h2>
                        <table class="table table-striped table-bordered dataTable no-footer">
                            <tbody>
                                <tr class="time_btn">
                                    <td class="time-remove"><span>8:00am To 9:00am</span> <button class="btn btn-primary" type="button">Delete</button></td>
                                </tr>

                                <tr class="time_btn">
                                    <td class="time-remove"><span>8:00am To 9:00am</span> <button class="btn btn-primary" type="button">Delete</button></td>
                                </tr>

                                <tr class="time_btn">
                                    <td class="time-remove"><span>8:00am To 9:00am</span> <button class="btn btn-primary" type="button">Delete</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div><!-- Thursday -->

                    <div class="table-responsive">
                        <h2>Friday</h2>
                        <table class="table table-striped table-bordered dataTable no-footer">
                            <tbody>
                                <tr class="time_btn">
                                    <td class="time-remove"><span>8:00am To 9:00am</span> <button class="btn btn-primary" type="button">Delete</button></td>
                                </tr>

                                <tr class="time_btn">
                                    <td class="time-remove"><span>8:00am To 9:00am</span> <button class="btn btn-primary" type="button">Delete</button></td>
                                </tr>

                                <tr class="time_btn">
                                    <td class="time-remove"><span>8:00am To 9:00am</span> <button class="btn btn-primary" type="button">Delete</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div><!-- Friday -->

                    <div class="table-responsive">
                        <h2>Saturday</h2>
                        <table class="table table-striped table-bordered dataTable no-footer">
                            <tbody>
                                <tr class="time_btn">
                                    <td class="time-remove"><span>8:00am To 9:00am</span> <button class="btn btn-primary" type="button">Delete</button></td>
                                </tr>

                                <tr class="time_btn">
                                    <td class="time-remove"><span>8:00am To 9:00am</span> <button class="btn btn-primary" type="button">Delete</button></td>
                                </tr>

                                <tr class="time_btn">
                                    <td class="time-remove"><span>8:00am To 9:00am</span> <button class="btn btn-primary" type="button">Delete</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div><!-- Saturday -->

                    <div class="table-responsive">
                        <h2>Sunday</h2>
                        <p>There is no time Slot available</p>
                    </div><!-- Sunday -->
                </div>
            </div><!-- Days -->
        </div>
    </div>
</div>



@section Scripts {

    <script type="text/javascript">
        var _objUpdate = null;
        var _objAdd = null;
        var _doctorId = 0;

    $(document).ready(function()
    {
        GetTimings();
     

        $('#DoctorTiming_from').bootstrapMaterialDatePicker
      ({
          date: false,
          shortTime: true,
          format: 'HH:mm A',

      });

        $('#DoctorTiming_to').bootstrapMaterialDatePicker
      ({
          date: false,
          shortTime: true,
          format: 'HH:mm A',

      });


      $.material.init()
    });


       

        function ValidateForm() {
            var success = "";

            if ($("#DoctorTiming_from").val().length == 0) {
                success = "Please enter from";
                return success;
            }
            if ($("#DoctorTiming_to").val().length == 0) {
                success = "Please enter to";
                return success;
            }
        }



        function GetTimings() {
            $("tbody[id$='timingTable']").html('');
            $("div[id$='divLoader']").show();
            var param = "{}";
            $.ajax({
                type: 'POST',
                url: '@Url.Action("GetDoctorTimings", "Doctor")',
                data: param,
                dataType: 'json',
                success: function (response) {
                    _objUpdate = response.DoctorTiming;
                    _doctorId = response.DoctorId;
                    bindTimingsTable(response.DoctorTimingsList);
                },
                error: errorRes

            });

        }

        function errorRes(data) {
            var err = eval("(" + data.responseText + ")");
            alert(err.Message);
        }
        function bindTimingsTable(doctorTimingList) {
            var tableHtml = "";
            for (var i = 0; i < doctorTimingList.length; i++) {
                tableHtml = tableHtml + "<tr>";
                tableHtml = tableHtml + "<td>" + doctorTimingList[i].day + "</td>";
                tableHtml = tableHtml + "<td>" + doctorTimingList[i].from + "</td>";
                tableHtml = tableHtml + "<td>" + doctorTimingList[i].to + "</td>";
                tableHtml = tableHtml + "<td><a href='#'  onclick='editObj(" + JSON.stringify(doctorTimingList[i]) + ",this);'> Edit</a> | <a href='#' onclick='deleteObj(" + doctorTimingList[i].doctorTimingsID + ")'>Delete</a></td>";
                tableHtml = tableHtml + "</tr>";
            }
            $("div[id$='divLoader']").hide();
            $("tbody[id$='timingTable']").html(tableHtml);
            

        }

        function editObj(objTiming) {
            $("#DoctorTiming_day").val(objTiming.day);
            $("#DoctorTiming_from").val(objTiming.from);
            $("#DoctorTiming_to").val(objTiming.to);
            $("#DoctorTiming_doctorTimingsID").val(objTiming.doctorTimingsID);
            _objUpdate = objTiming;
        }
        function reset() {
            $("#DoctorTiming_day").prop("selectedIndex", 0);
            $("#DoctorTiming_from").val('');
            $("#DoctorTiming_to").val('');
            $("#DoctorTiming_doctorTimingsID").val('0');
            _objUpdate = null;
        }

        function deleteObj(doctorTimingsID) {
            //alert(day);
        }



        function addUpdate() {
            var msg = ValidateForm();
            if (msg == "" || msg==undefined) {
                fillObj();

                var _data;
                if (_objUpdate == null) {
                    _data = _objAdd ;
                }
                else {
                    _data =_objUpdate ;
                }
                $("div[id$='divLoader']").show();
                $.ajax({
                    type: 'POST',
                    url: '@Url.Action("CreateEditTimings", "Doctor")',
                    data: _data,
                    dataType: 'json',
                    success: function (response) {
                        reset();
                        GetTimings();
                        _objUpdate = null;
                    },
                    error: errorRes

                });

            }
            else {
                alert(msg);
            }


        }

        function deleteObj(doctorTimingsID) {
            var confirmMessage = confirm("Are you sure you want to delete?");
            if (confirmMessage == false)
                return false;

            $("div[id$='divLoader']").show();
                $.ajax({
                    type: 'POST',
                    url: '@Url.Action("DeleteDoctorTiming", "Doctor")',
                    data: { 'id': doctorTimingsID },
                    dataType: 'json',
                    success: function () {
                        GetTimings();
                    },
                    error: errorRes

                });
         }


        function fillObj() {

            if (_objUpdate == null) {
                _objAdd = {};
                _objAdd["doctorID"] = _doctorId;
                _objAdd["doctorTimingsID"] = 0;
                _objAdd["day"] = $("#DoctorTiming_day").val();
                _objAdd["from"] = $("#DoctorTiming_from").val();
                _objAdd["to"] = $("#DoctorTiming_to").val();
            }
            else {
                _objUpdate.doctorTimingsID = parseInt($("#DoctorTiming_doctorTimingsID").val());
                _objUpdate.day = $("#DoctorTiming_day").val();
                _objUpdate.from = $("#DoctorTiming_from").val();
                _objUpdate.to = $("#DoctorTiming_to").val();
            }
        }




    </script>
}



